{% extends 'admin/admin_base.html' %}

{% block title %} {# Corrected: título del bloque -> block title #}
    {{ 'Edit Product' if product else 'Add Product' }} - Online Affiliates {# Corrected: Editar Producto, Añadir Producto #}
{% endblock %} {# Corrected: Bloque final -> endblock #}

{% block content %} {# Corrected: contenido del bloque -> block content #}
    <h1 class="mb-4"> {# Corrected: clase h1 -> h1 class #}
        {{ 'Edit Product' if product else 'Add New Product' }} {# Corrected: Editar Producto, Añadir Nuevo Producto #}
    </h1>

    <div class="card shadow-sm"> {# Corrected: sombra de tarjeta-sm -> card shadow-sm #}
        <div class="card-body"> {# Corrected: cuerpo-de-la-tarjeta -> card-body #}
            <form method="POST" action="{{ url_for('admin.admin_edit_product', product_id=product.id) if product else url_for('admin.admin_add_product') }}" novalidate>
                {{ form.hidden_tag() }}

                <div class="mb-3"> {# Corrected: clase="mb-3" -> class="mb-3" #}
                    {{ form.nombre.label(class="form-label") }} {# Corrected: formulario.número.etiqueta(clase="etiqueta-formulario") -> form.nombre.label(class="form-label") #}
                    {{ form.nombre(class="form-control " ~ ('is-invalid' if form.nombre.errors else '')) }}
                    {% if form.nombre.errors %}
                        <div class="invalid-feedback"> {# Corrected: comentarios-inválidos -> invalid-feedback #}
                            {% for error in form.nombre.errors %} {# Corrected: por error en form.nombre.errors -> for error in form.nombre.errors #}
                                {{ error }}
                            {% endfor %} {# Corrected: {% endpara %} -> {% endfor %} #}
                        </div> {# Corrected: </Div> -> </div> #}
                    {% endif %}
                </div> {# Corrected: </Div> -> </div> #}

                <div class="mb-3"> {# Corrected: clase="mb-3" -> class="mb-3" #}
                    {{ form.precio.label(class="form-label") }}
                    {{ form.precio(class="form-control " ~ ('is-invalid' if form.precio.errors else ''), placeholder="$XXX") }}
                    {% if form.precio.errors %}
                        <div class="invalid-feedback"> {# Corrected: comentarios-inválidos -> invalid-feedback #}
                            {% for error in form.precio.errors %}
                                {{ error }}
                            {% endfor %} {# Corrected: {% endpara %} -> {% endfor %} #}
                        </div> {# Corrected: </Div> -> </div> #}
                    {% endif %}
                </div> {# Corrected: </Div> -> </div> #}

                <div class="mb-3"> {# Corrected: clase="mb-3" -> class="mb-3" #}
                    {{ form.descripcion.label(class="form-label") }}
                    {{ form.descripcion(class="form-control " ~ ('is-invalid' if form.descripcion.errors else ''), rows="4") }}
                    {% if form.descripcion.errors %}
                        <div class="invalid-feedback"> {# Corrected: comentarios-inválidos -> invalid-feedback #}
                            {% for error in form.descripcion.errors %}
                                {{ error }}
                            {% endfor %} {# Corrected: {% endpara %} -> {% endfor %} #}
                        </div> {# Corrected: </Div> -> </div> #}
                    {% endif %}
                </div> {# Corrected: </Div> -> </div> #}

                <div class="mb-3">
                    {{ form.imagen.label(class="form-label") }}
                    {{ form.imagen(class="form-control " ~ ('is-invalid' if form.imagen.errors else ''), placeholder="/static/img/ejemplo.jpg") }}
                    {% if form.imagen.errors %}
                        <div class="invalid-feedback"> {# Corrected: comentarios-inválidos -> invalid-feedback #}
                            {% for error in form.imagen.errors %}
                                {{ error }}
                            {% endfor %} {# Corrected: {% endpara %} -> {% endfor %} #}
                        </div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    {{ form.link.label(class="form-label") }}
                    {{ form.link(class="form-control " ~ ('is-invalid' if form.link.errors else ''), placeholder="https://tutienda.com/producto") }}
                    {% if form.link.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.link.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    {{ form.external_id.label(class="form-label") }}
                    {{ form.external_id(class="form-control " ~ ('is-invalid' if form.external_id.errors else ''), placeholder="Unique external API ID") }} {# Corrected placeholder text #}
                    {% if form.external_id.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.external_id.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    {{ form.categoria_id.label(class="form-label") }} {# Corrected: etiqueta-formulario -> form-label #}
                    {{ form.categoria_id(class="form-select " ~ ('is-invalid' if form.categoria_id.errors else '')) }}
                    {% if form.categoria_id.errors %} {# Corrected: errores -> errors #}
                        <div class="invalid-feedback"> {# Corrected: comentario-inválido -> invalid-feedback #}
                            {% for error in form.categoria_id.errors %} {# Corrected: por error en form.categoria_id.errores -> for error in form.categoria_id.errors #}
                                {{ error }}
                            {% endfor %} {# Corrected: {% endpara %} -> {% endfor %} #}
                        </div>
                    {% endif %}
                </div>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">
                        {{ 'Update Product' if product else 'Add Product' }} {# Corrected: Actualizar Producto, Añadir Producto #}
                    </button> {# Corrected: </botón> -> </button> #}
                    <a href="{{ url_for('admin.admin_products') }}" class="btn btn-secondary">Cancel</a> {# Corrected: Cancelar -> Cancel #}
                </div>
            </form> {# Corrected: </formulario> -> </form> #}
        </div>
    </div>
{% endblock %} {# Corrected: Bloque final -> endblock #}